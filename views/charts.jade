extends main-container

link(rel="icon" href="/user/favicon.ico" type="image/x-icon")
link(rel="shortcut icon" href="/user/favicon.ico" type="image/x-icon")
link(rel='stylesheet', href='/user/stylesheets/bootstrap.min.css')
link(href='/user/stylesheets/jquery-ui.min.css', rel='stylesheet', media='screen')
link(rel='stylesheet', href='https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css')
link(rel='stylesheet', href='//cdn.datatables.net/1.10.5/css/jquery.dataTables.min.css')
link(rel='stylesheet', href='https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap-theme.min.css')
link(rel='stylesheet', href='//cdn.datatables.net/plug-ins/f2c75b7247b/integration/bootstrap/3/dataTables.bootstrap.css')
link(rel='stylesheet', href='//cdn.datatables.net/1.10.5/css/jquery.dataTables.min.css')
link(rel='stylesheet', href='//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css')
script(src="//code.jquery.com/jquery-1.11.2.min.js")
script(src="//cdn.datatables.net/1.10.5/js/jquery.dataTables.min.js")
script(src='//cdn.datatables.net/plug-ins/f2c75b7247b/integration/bootstrap/3/dataTables.bootstrap.js')
script(src='https://code.highcharts.com/highcharts.js')
script(src="https://code.highcharts.com/modules/data.js")
script(src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js")
link#twentytwelve-fonts-css(rel='stylesheet', href='https://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,400,700&subset=latin,latin-ext', type='text/css', media='all')
link#twentytwelve-style-css(rel='stylesheet', href='/wp-content/themes/openi/style1bba.css?ver=3.5', type='text/css', media='all')
//if lt IE 9
    link#twentytwelve-ie-css(rel='stylesheet', href='https://www.openi-ict.eu/wp-content/themes/openi/css/ie.css?ver=20121010', type='text/css', media='all')
link(rel='stylesheet', href='/user/stylesheets/style.css')

block content
    div.panel.panel-default
        div.panel-body
        h3 Access log
        div This page lists the amount of times that your data is accessed and who is accessing it.
            .row.hidden
                .col-md-8.col-md-offset-2
                    table.table.table-striped.table-bordered#app
                        caption Track By App
                        thead
                            tr
                                th APP
                                th Requests
                        tbody
            .row.hidden
                .col-md-8.col-md-offset-2
                    table.table.table-striped.table-bordered#company
                        caption Track By Company
                        thead
                            tr
                                th APP
                                th Requests
                        tbody
            .row.hidden
                .col-md-8.col-md-offset-2
                    table.table.table-striped.table-bordered#loc
                        caption Track By Location
                        thead
                            tr
                                th APP
                                th Requests
                        tbody
            .row.hidden
                .col-md-8.col-md-offset-2
                    table.table.table-striped.table-bordered#obj
                        caption Track By Object
                        thead
                            tr
                                th Object Data
                                th Requests
                                th Object ID
                        tbody
            .row
                table.table.table-striped.table-bordered#visits(style="position: absolute; left: -9999em;")
                    caption Visits
                    thead
                        tr
                            th DATE
                            th Requests
                    tbody
                        each val, index in visitResults
                            tr
                                td= index
                                td= val
            .row
                .col-md-8.col-md-offset-2
                    #visitChartContainer
            .row &nbsp;
            .row
                hr
            .row &nbsp;
            .row
                .col-md-8.col-md-offset-2
                    #companyChartContainer
            .row &nbsp;
            .row
                hr
            .row &nbsp;
            .row
                .col-md-8.col-md-offset-2
                    #appChartContainer
            .row &nbsp;
            .row
                hr
            .row &nbsp;
            .row
                .col-md-8.col-md-offset-2
                    #objChartContainer
            .row &nbsp;
            .row
                hr
            .row &nbsp;
            .row
                .col-md-8.col-md-offset-2
                    #locChartContainer

    block append scripts
        script("type=text/javascript").
            $(document).ready(function () {
                var companyResults = !{JSON.stringify(companyResults)};
                $('#company').DataTable({
                "bProcessing" : true,
                data: companyResults,
                columns: [
                {data: 'label'},
                {data: 'nb_visits'}
                ]
                });
                var objResults = !{JSON.stringify(objResults)};
                $('#obj').DataTable({
                "bProcessing" : true,
                data: objResults,
                columns: [
                {data: 'contentTarget'},
                {data: 'nb_visits'},
                {data: 'label'}
                ]
                });
                var locResults = !{JSON.stringify(locResults)};
                $('#loc').DataTable({
                "bProcessing" : true,
                data: locResults,
                columns: [
                {data: 'label'},
                {data: 'nb_visits'}
                ]
                });
                var appResults = !{JSON.stringify(appResults)};
                $('#app').DataTable({
                    "bProcessing": true,
                    data         : appResults,
                    columns      : [
                        {data: 'label'},
                        {data: 'nb_visits'}
                    ]
                });
                $('#companyChartContainer').highcharts({
                    data: {
                        table: 'company'
                    },
                    chart: {
                        type: 'pie'
                    },
                    title: {
                        text: 'Requests Per Company'
                    },
                    yAxis: {
                        allowDecimals: false,
                        title: {
                            text: 'Requests'
                        },
                        min: 0
                    },
                    credits: {
                        enabled: false
                    }
                });
                $('#appChartContainer').highcharts({
                    data: {
                        table: 'app'
                    },
                    chart: {
                        type: 'column'
                    },
                    title: {
                        text: 'Requests Per App'
                    },
                    yAxis: {
                        allowDecimals: false,
                        title: {
                            text: 'Requests'
                        },
                        min: 0
                    },
                    credits: {
                        enabled: false
                    }
                });
                $('#objChartContainer').highcharts({
                    data: {
                        table: 'obj',
                        endColumn: 1
                    },
                    chart: {
                        type: 'column'
                    },
                    title: {
                        text: 'Requests Per Object'
                    },
                    yAxis: {
                        allowDecimals: false,
                        title: {
                            text: 'Requests'
                        },
                        min: 0
                    },
                    credits: {
                        enabled: false
                    }
                });
                $('#locChartContainer').highcharts({
                    data: {
                        table: 'loc'
                    },
                    chart: {
                        type: 'column'
                    },
                    title: {
                        text: 'Requests Per Location'
                    },
                    yAxis: {
                        allowDecimals: false,
                        title: {
                            text: 'Requests'
                        },
                        min: 0
                    },
                    credits: {
                        enabled: false
                    }
                });
                $('#visitChartContainer').highcharts({
                    data: {
                        table: 'visits'
                    },
                    chart: {
                        type: 'line'
                    },
                    title: {
                        text: 'Requests Over Time'
                    },
                    yAxis: {
                        allowDecimals: false,
                        title: {
                            text: 'Requests'
                        },
                        min: 0
                    },
                    credits: {
                        enabled: false
                    }
            });

            });


